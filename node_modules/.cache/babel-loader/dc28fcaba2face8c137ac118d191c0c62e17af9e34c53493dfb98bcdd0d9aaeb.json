{"ast":null,"code":"import _slicedToArray from\"/Users/farkhadov950405/Desktop/HTML_Academy/Projects/WhatToWatch/853355-what-to-watch-12/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{AppRoute,AuthorizationStatus}from'../../const';import{useAppDispatch,useAppSelector}from'../../hooks';import{processErrorHandle}from'../../services/process-error-handler';import{setFavoriteStatusAction}from'../../store/films-data/films-data';import{authorizationStatusSelector,filmsSelector}from'../../store/selectors';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function MyListButton(_ref){var id=_ref.id;var authorizationStatus=useAppSelector(authorizationStatusSelector);var filmsArray=useAppSelector(filmsSelector);var dispatch=useAppDispatch();var navigate=useNavigate();var film=filmsArray.find(function(item){return item.id===Number(id);});var getFavoritesNumber=function getFavoritesNumber(){var favorites=filmsArray.filter(function(item){return item.isFavorite;});return favorites.length;};var _useState=useState(getFavoritesNumber()),_useState2=_slicedToArray(_useState,2),favoritesCount=_useState2[0],setFavoritesCount=_useState2[1];useEffect(function(){setFavoritesCount(getFavoritesNumber());},[filmsArray]);var onStatusClick=function onStatusClick(){if(authorizationStatus===AuthorizationStatus.Auth){dispatch(setFavoriteStatusAction({id:Number(id),status:film!==null&&film!==void 0&&film.isFavorite?0:1}));}else{navigate(AppRoute.Login);processErrorHandle('Please, log in to add this film to your list');}};return/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn--list film-card__button\",type:\"button\",onClick:onStatusClick,children:[film!==null&&film!==void 0&&film.isFavorite?/*#__PURE__*/_jsx(\"svg\",{width:\"18\",height:\"14\",viewBox:\"0 0 18 14\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",clipRule:\"evenodd\",d:\"M2.40513 5.35353L6.1818 8.90902L15.5807 0L18 2.80485L6.18935 14L0 8.17346L2.40513 5.35353Z\",fill:\"#EEE5B5\"})}):/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 19 20\",width:\"19\",height:\"20\",children:/*#__PURE__*/_jsx(\"use\",{xlinkHref:\"#add\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"My list\"}),/*#__PURE__*/_jsx(\"span\",{className:\"film-card__count\",children:favoritesCount})]});}export default MyListButton;","map":{"version":3,"names":["useEffect","useState","useNavigate","AppRoute","AuthorizationStatus","useAppDispatch","useAppSelector","processErrorHandle","setFavoriteStatusAction","authorizationStatusSelector","filmsSelector","jsx","_jsx","jsxs","_jsxs","MyListButton","_ref","id","authorizationStatus","filmsArray","dispatch","navigate","film","find","item","Number","getFavoritesNumber","favorites","filter","isFavorite","length","_useState","_useState2","_slicedToArray","favoritesCount","setFavoritesCount","onStatusClick","Auth","status","Login","className","type","onClick","children","width","height","viewBox","fill","xmlns","fillRule","clipRule","d","xlinkHref"],"sources":["/Users/farkhadov950405/Desktop/HTML_Academy/Projects/WhatToWatch/853355-what-to-watch-12/src/components/mylist-button/mylist-button.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { AppRoute, AuthorizationStatus } from '../../const';\nimport { useAppDispatch, useAppSelector } from '../../hooks';\nimport { processErrorHandle } from '../../services/process-error-handler';\nimport { setFavoriteStatusAction } from '../../store/films-data/films-data';\nimport { authorizationStatusSelector, filmsSelector } from '../../store/selectors';\n\ntype MyListButtonProps = {\n    id: number;\n}\n\nfunction MyListButton({id}: MyListButtonProps): JSX.Element {\n  const authorizationStatus = useAppSelector(authorizationStatusSelector);\n  const filmsArray = useAppSelector(filmsSelector);\n  const dispatch = useAppDispatch();\n  const navigate = useNavigate();\n\n  const film = filmsArray.find((item) => item.id === Number(id));\n  const getFavoritesNumber = () => {\n    const favorites = filmsArray.filter((item) => item.isFavorite);\n    return favorites.length;\n  };\n\n  const [favoritesCount, setFavoritesCount] = useState(getFavoritesNumber());\n\n  useEffect(() => {\n    setFavoritesCount(getFavoritesNumber());\n  }, [filmsArray]);\n\n  const onStatusClick = () => {\n    if (authorizationStatus === AuthorizationStatus.Auth) {\n      dispatch(setFavoriteStatusAction({id: Number(id), status: film?.isFavorite ? 0 : 1}));\n    } else {\n      navigate(AppRoute.Login);\n      processErrorHandle('Please, log in to add this film to your list');\n    }\n  };\n\n  return (\n    <button className=\"btn btn--list film-card__button\" type=\"button\" onClick={onStatusClick}>\n      {\n        film?.isFavorite ?\n          <svg width=\"18\" height=\"14\" viewBox=\"0 0 18 14\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M2.40513 5.35353L6.1818 8.90902L15.5807 0L18 2.80485L6.18935 14L0 8.17346L2.40513 5.35353Z\" fill=\"#EEE5B5\"/>\n          </svg> :\n          <svg viewBox=\"0 0 19 20\" width=\"19\" height=\"20\">\n            <use xlinkHref=\"#add\"></use>\n          </svg>\n      }\n      <span>My list</span>\n      <span className=\"film-card__count\">{favoritesCount}</span>\n    </button>\n  );\n}\n\nexport default MyListButton;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}