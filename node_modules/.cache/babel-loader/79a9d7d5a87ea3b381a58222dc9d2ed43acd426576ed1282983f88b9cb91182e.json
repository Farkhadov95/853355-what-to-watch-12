{"ast":null,"code":"import _defineProperty from\"/Users/farkhadov950405/Desktop/HTML_Academy/Projects/WhatToWatch/853355-what-to-watch-12/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/farkhadov950405/Desktop/HTML_Academy/Projects/WhatToWatch/853355-what-to-watch-12/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/farkhadov950405/Desktop/HTML_Academy/Projects/WhatToWatch/853355-what-to-watch-12/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{postReviewAction}from'../../store/films-data/films-data';import RatingStar from'../rating-star/rating-star';import{processErrorHandle}from'../../services/process-error-handler';import ErrorMessage from'../error-message/error-message';import{useAppDispatch,useAppSelector}from'../../hooks';import{errorSelector,isReviewSendingSelector}from'../../store/selectors';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ReviewForm(_ref){var id=_ref.id;var isReviewSending=useAppSelector(isReviewSendingSelector);var errorMessage=useAppSelector(errorSelector);var dispatch=useAppDispatch();var starsCount=Array.from({length:10},function(_,i){return 10-i;});var _useState=useState({comment:'',rating:''}),_useState2=_slicedToArray(_useState,2),reviewInfo=_useState2[0],setReviewInfo=_useState2[1];useEffect(function(){if(errorMessage){processErrorHandle(errorMessage);}},[errorMessage]);var onChangeHandler=function onChangeHandler(evt){evt.persist();var _evt$target=evt.target,name=_evt$target.name,value=_evt$target.value;setReviewInfo(_objectSpread(_objectSpread({},reviewInfo),{},_defineProperty({},name,value)));};var review={comment:reviewInfo.comment,rating:Number(reviewInfo.rating)};var onSubmitHandler=function onSubmitHandler(evt){evt.preventDefault();if(reviewInfo.comment.length<50||reviewInfo.comment.length>400){processErrorHandle('The comment must be between 50 and 400 characters long.');return;}dispatch(postReviewAction({id:id,review:review}));};return/*#__PURE__*/_jsxs(\"form\",{action:\"#\",className:\"add-review__form\",onSubmit:onSubmitHandler,children:[/*#__PURE__*/_jsx(ErrorMessage,{}),/*#__PURE__*/_jsx(\"div\",{className:\"rating\",children:/*#__PURE__*/_jsx(\"div\",{className:\"rating__stars\",children:starsCount.map(function(i){return/*#__PURE__*/_jsx(RatingStar,{orderNumber:i,changeHandler:onChangeHandler,currentStateID:reviewInfo['rating'],isReviewSending:isReviewSending},i);})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"add-review__text\",children:[/*#__PURE__*/_jsx(\"textarea\",{className:\"add-review__textarea\",name:\"comment\",id:\"review-text\",placeholder:\"Review text\",onChange:onChangeHandler,value:reviewInfo.comment,disabled:isReviewSending}),/*#__PURE__*/_jsx(\"div\",{className:\"add-review__submit\",children:/*#__PURE__*/_jsx(\"button\",{disabled:!reviewInfo.comment||!reviewInfo.rating||isReviewSending,className:\"add-review__btn\",type:\"submit\",children:\"Post\"})})]})]});}export default ReviewForm;","map":{"version":3,"names":["React","useEffect","useState","postReviewAction","RatingStar","processErrorHandle","ErrorMessage","useAppDispatch","useAppSelector","errorSelector","isReviewSendingSelector","jsx","_jsx","jsxs","_jsxs","ReviewForm","_ref","id","isReviewSending","errorMessage","dispatch","starsCount","Array","from","length","_","i","_useState","comment","rating","_useState2","_slicedToArray","reviewInfo","setReviewInfo","onChangeHandler","evt","persist","_evt$target","target","name","value","_objectSpread","_defineProperty","review","Number","onSubmitHandler","preventDefault","action","className","onSubmit","children","map","orderNumber","changeHandler","currentStateID","placeholder","onChange","disabled","type"],"sources":["/Users/farkhadov950405/Desktop/HTML_Academy/Projects/WhatToWatch/853355-what-to-watch-12/src/components/review-form/review-form.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { postReviewAction } from '../../store/films-data/films-data';\nimport { PostReview } from '../../types/films';\nimport RatingStar from '../rating-star/rating-star';\nimport { processErrorHandle } from '../../services/process-error-handler';\nimport ErrorMessage from '../error-message/error-message';\nimport { useAppDispatch, useAppSelector } from '../../hooks';\nimport { errorSelector, isReviewSendingSelector } from '../../store/selectors';\n\ntype ReviewFormProps = {\n  id: number;\n}\n\nfunction ReviewForm({id}: ReviewFormProps): JSX.Element {\n  const isReviewSending = useAppSelector(isReviewSendingSelector);\n  const errorMessage = useAppSelector(errorSelector);\n  const dispatch = useAppDispatch();\n  const starsCount = Array.from({length: 10}, (_, i) => (10 - i));\n  const [reviewInfo, setReviewInfo] = useState({\n    comment: '',\n    rating: '',\n  });\n\n  useEffect(() => {\n    if (errorMessage) {\n      processErrorHandle(errorMessage);\n    }\n  }, [errorMessage]);\n\n  const onChangeHandler = (evt: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement >) => {\n    evt.persist();\n    const { name, value } = evt.target;\n    setReviewInfo({...reviewInfo, [name]: value});\n  };\n\n  const review: PostReview = {\n    comment: reviewInfo.comment,\n    rating: Number(reviewInfo.rating),\n  };\n\n  const onSubmitHandler = (evt: React.FormEvent<HTMLFormElement>) => {\n    evt.preventDefault();\n    if (reviewInfo.comment.length < 50 || reviewInfo.comment.length > 400) {\n      processErrorHandle('The comment must be between 50 and 400 characters long.');\n      return;\n    }\n    dispatch(postReviewAction({id, review}));\n  };\n\n  return (\n    <form action=\"#\" className=\"add-review__form\" onSubmit={onSubmitHandler}>\n      <ErrorMessage />\n      <div className=\"rating\">\n        <div className=\"rating__stars\">\n          {\n            starsCount.map((i) => (\n              <RatingStar key={i}\n                orderNumber={i}\n                changeHandler={onChangeHandler}\n                currentStateID={reviewInfo['rating']}\n                isReviewSending={isReviewSending}\n              />\n            ))\n          }\n        </div>\n      </div>\n\n      <div className=\"add-review__text\">\n        <textarea className=\"add-review__textarea\"\n          name=\"comment\"\n          id=\"review-text\"\n          placeholder=\"Review text\"\n          onChange={onChangeHandler}\n          value={reviewInfo.comment}\n          disabled={isReviewSending}\n        >\n        </textarea>\n        <div className=\"add-review__submit\">\n          <button disabled={!reviewInfo.comment || !reviewInfo.rating || isReviewSending} className=\"add-review__btn\" type=\"submit\">Post</button>\n        </div>\n\n      </div>\n    </form>\n  );\n}\n\nexport default ReviewForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}